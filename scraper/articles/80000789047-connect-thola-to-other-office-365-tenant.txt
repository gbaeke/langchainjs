This article describes the steps needed to connect your own organisation in Thola to your own Azure AD / Office 365 Tenant. The result will be that all meetings will be created in your own tenant and not in the tenant of Thola.Â Follow the next steps in Azure Active DirectoryCreate a new App RegistrationThola as an application needs to be recognized by the tenant it interacts with. This is done by registering Thola as an application (App Registration) in the tenant.The name or description of the application can be anything the administrator likes. This registration will not be visually presented to the users. However this application does need the following Microsoft Graph permissions:OnlineMeetings.ReadWrite.All: Needed to create online meetings (see Microsoft Docs )Aside of the permissions Thola will require a valid secret for this application.Steps to follow:Go to Azure Active Directory in the Azure Portal (https://portal.azure.com )Go to App RegistrationsCreate a new registrationClick on "+ New Registartion"Name: free to chooseSupported Account Types: free to choose (we do not use this application for authentication users but you need to choose an option)Click Register and the details of the app registration will openCopy Tenant Id & Client ID to provide to TholaGive the required permissionsIn the left menu click on API permissionClick on Add PermissionsSelect "Graph API"Select "Application permissions"Search for OnlineMeetings and select "OnlineMeetings.ReadWrite.All"Click on "Add Permission"Admin consent is required for this permission. Above the table you neen to click on "Grant admin consent for {tenantname}" and select "yes" in the dialog.Create a secret and share the secret with usClick on "Certificates & secrets"Click on "+ New client secret"Provide a description to know this token is for TholaEnter a description and a period of "24 months" (you can always substract the client secret to stop our access)Copy the value to provide to TholaThat is all you need to do in the Azure portal.Create meeting organizer userOnline meetings in Teams require an organizer to create the meeting. This organizer can not be a guest to tenant and needs to have a regular user with a licence for Teams.When creating this account please copy the ID of the user to provide to Thola. At this point we do not need a password from that user or access via an access policy to be able to create the online meetings.Security considerationsThola is set up to connect to the Graph API with an application (using ClientId and ClientSecret). This allows you as the Tenant owner to fine tune specific access to our application. By restricting the permission to the online meeting's category (OnlineMeetings.ReadWrite.All), Thola will not be able to access any other resource like Chats or Meetings.Secondly for this permission there is a second level of security namely access policies (more info). Access policies contain the users for which online meetings can be created or can be queried. You need to specify at minimum one access policy in order for an application to access online meetings.However, Thola only needs to create online meetings. It therefore doesn't need access to the online meetings of a specific person (the meeting organizer). The only requirement to create an online meeting is that it contains an organizer. This is an undocumented feature we discovered during development and are using it in corporation with Microsoft. Nevertheless, this feature is also part of their Beta endpoints and are subjected to possible changes when it is finally validated.Remark: If the endpoint does not make it to the final version we are required to have access to the organizers online meetings. And this should be granted with an access policy. Keep in mind having access to online meeting does not grant us access to the content of any chat thread or to any video stream from that meeting.Follow the next steps in Office 365 Teams AdminIn Teams we need a separate Meeting Policy with options only applicable on meetings that will be created by Thola. This separates our rights from the normal user rights in your Teams tenant. The options you would like to enable is depending on the security level you would like to set on these meetings. This can best be discussed in a separate meeting but we will already give instructions on what needs te be done regardless which rights you will set.Steps to follow:Go to Teams admin dashboard (https://admin.teams.microsoft.com/dashboard )Click on "Meetings > Meeting Policies"Click on "+ Add" to create a new meeting policyProvide a meaningfull name so you know this is policy used by TholaYou are free to add a descriptionSet the meeting options depending on your choice. For Thola the most important is to define the Lobby as required. This is handled by the property "Automatically admit people".Click on SaveAssign this newly created policy to the Teams user created as the Meeting organizerIn the left pane click on "Users"Search for this user and click on the user to go to the detailsClick on policiesClick on the "Edit" buttonIn the panel "Edit user policies" change the Meeting policy to the newly created policyClick "ApplyNow the new policy is only used by the user that will be provided to Thola and we can only create meetings according the selected options. These optiosn can be changed without the need to contact us.Setup in TholaCurrently, there is no User interface for updating this information. Please provide the information below to our technical team via support@thola.events and they will update this information for your organisation. The client secret will be stored in a secure Azure KeyVault and after a confirmation that all setup is ok we will remove the secret from other data stores like email.In order to activate the external tenant we need:TenantId: An guid identifier of the tenant to targetClientId: The client guid with the correct permissionsClientSecret: Previously created secret for the clientMeetingOrganiserId: The object id of the user